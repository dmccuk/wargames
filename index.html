<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WOPR // Channel Operations</title>
  <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root{ --phosphor:#33ff33; --grid:#2fa62f; --bg:#0a0a0a; }
    body { background: var(--bg); font-family: 'VT323', monospace; color: var(--phosphor); overflow: hidden; font-size: 14px; text-shadow: 0 0 3px var(--phosphor); }

    /* SPLASH */
    #splash { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 1; transition: opacity 1s; }
    #splash.fade-out { opacity: 0; pointer-events: none; }
    #splash-canvas { width: 60vw; height: 60vh; max-width: 800px; max-height: 600px; }
    #splash-log { margin-top: 30px; font-size: 16px; text-shadow: 0 0 8px var(--phosphor); min-height: 120px; text-align: center; }
    #splash-log > div { margin: 8px 0; opacity: 0; animation: fadeIn 0.3s forwards; }
    @keyframes fadeIn { to { opacity: 1; } }

    #header, #footer { position: absolute; left: 0; right: 0; padding: 10px 20px; display: flex; justify-content: space-between; align-items:center; text-shadow: 0 0 8px var(--phosphor); z-index: 100; background: rgba(10, 10, 10, 0.9); border: 2px solid var(--phosphor); }
    #header{ top:0; border-bottom-width:2px; border-top:none; }
    #footer{ bottom:0; border-top-width:2px; border-bottom:none; }
    #main-container { position: absolute; top: 50px; bottom: 50px; left: 0; right: 0; }

    /* DRAGGABLE TERMINAL */
    #terminal-section { position: fixed; left: 10px; bottom: 10px; width: 400px; height: 300px; border: 1px solid var(--phosphor); display: flex; flex-direction: column; background: rgba(5,15,5,0.95); box-shadow: 0 0 20px rgba(51,255,51,0.2); z-index: 200; }
    #term-handle { background: rgba(0, 30, 0, 0.9); border-bottom: 1px solid var(--phosphor); padding: 6px 10px; cursor: move; user-select: none; font-size: 13px; display: flex; justify-content: space-between; }
    #term-handle:active { cursor: grabbing; }
    #terminal-output { flex: 1; overflow-y: auto; padding: 10px; font-size: 12px; }
    #input-line { padding: 6px 10px; border-top: 1px solid var(--phosphor); display:flex; align-items:center; gap:6px; background: rgba(0, 20, 0, 0.5); }
    #command-input { flex:1; background: transparent; border: none; color: var(--phosphor); font-family: 'VT323', monospace; font-size: 14px; outline: none; }
    
    #right { position:absolute; inset:0; padding: 10px; display:grid; grid-template-rows: 2fr 1fr; gap: 10px; }
    .monitor-box { border: 1px solid var(--phosphor); background: #000; position: relative; overflow:hidden; }
    .monitor-title { position: absolute; top: 5px; left: 10px; font-size: 13px; z-index: 10; }
    canvas { display:block; width:100%; height:100%; }
    .cursor { display:inline-block; width:8px; height:14px; background: var(--phosphor); animation: blink 1s infinite; }
    @keyframes blink { 0%,49%{opacity:1} 50%,100%{opacity:0} }
  </style>
</head>
<body>
  <div id="splash">
    <canvas id="splash-canvas"></canvas>
    <div id="splash-log"></div>
  </div>

  <div id="header">
    <div>W.O.P.R // CHANNEL OPERATIONS</div>
    <div>CONNECTION: <span id="status">INITIALIZING</span></div>
  </div>

  <div id="main-container">
    <section id="terminal-section">
      <div id="term-handle">
        <span>WOPR CONSOLE</span>
        <span style="font-size:11px; opacity:0.7;">DRAG TO MOVE</span>
      </div>
      <div id="terminal-output"></div>
      <div id="input-line">
        <span>&gt;</span>
        <input type="text" id="command-input" placeholder="Type HELP" />
        <span class="cursor"></span>
      </div>
    </section>

    <section id="right">
      <div class="monitor-box">
        <div class="monitor-title">GLOBAL THEATER</div>
        <canvas id="world-canvas"></canvas>
      </div>
      <div class="monitor-box">
        <div class="monitor-title">ANALYTICS OVERVIEW</div>
        <canvas id="chart-canvas"></canvas>
      </div>
    </section>
  </div>

  <div id="footer">
    <div>NORAD // CHEYENNE MTN</div>
    <div>DEFCON: <span id="defcon">5</span></div>
  </div>

  <script>
  // SPLASH BOOT
  const splash = document.getElementById('splash');
  const splashCanvas = document.getElementById('splash-canvas');
  const splashLog = document.getElementById('splash-log');
  const splashCtx = splashCanvas.getContext('2d');

  const bootMessages = [
    'BOOT SEQUENCE INITIATED...',
    'LOADING W.O.P.R CORE SYSTEMS...',
    'ESTABLISHING SECURE LINK...',
    'CONNECTING TO NORAD: CHEYENNE MTN...',
    'INITIALIZING GLOBAL THEATER MAP...',
    'SYSTEM DIAGNOSTICS: PASSED',
    'W.O.P.R ONLINE // READY'
  ];

  function fitSplashCanvas() {
    const dpr = window.devicePixelRatio || 1;
    const w = splashCanvas.clientWidth;
    const h = splashCanvas.clientHeight;
    splashCanvas.width = w * dpr;
    splashCanvas.height = h * dpr;
    splashCtx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }

  function drawSplashGlobe() {
    const w = splashCanvas.clientWidth;
    const h = splashCanvas.clientHeight;
    splashCtx.clearRect(0, 0, w, h);
    
    // Grid
    splashCtx.save();
    splashCtx.strokeStyle = '#2fa62f';
    splashCtx.globalAlpha = 0.15;
    splashCtx.lineWidth = 0.5;
    for(let i = 0; i <= 20; i++) {
      splashCtx.beginPath();
      splashCtx.moveTo(i * w / 20, 0);
      splashCtx.lineTo(i * w / 20, h);
      splashCtx.stroke();
    }
    for(let i = 0; i <= 12; i++) {
      splashCtx.beginPath();
      splashCtx.moveTo(0, i * h / 12);
      splashCtx.lineTo(w, i * h / 12);
      splashCtx.stroke();
    }
    splashCtx.restore();
    
    // Wireframe globe
    splashCtx.save();
    splashCtx.strokeStyle = '#33ff33';
    splashCtx.globalAlpha = 0.6;
    splashCtx.lineWidth = 1;
    const cx = w / 2, cy = h / 2, r = Math.min(w, h) * 0.35;
    
    splashCtx.beginPath();
    splashCtx.arc(cx, cy, r, 0, Math.PI * 2);
    splashCtx.stroke();
    
    for(let i = 1; i < 6; i++) {
      const ry = r * Math.sin(i * Math.PI / 6);
      splashCtx.beginPath();
      splashCtx.ellipse(cx, cy, r * Math.cos(i * Math.PI / 6), ry, 0, 0, Math.PI * 2);
      splashCtx.stroke();
    }
    
    for(let i = 0; i < 6; i++) {
      splashCtx.beginPath();
      splashCtx.ellipse(cx, cy, r * Math.abs(Math.cos(i * Math.PI / 6)), r, 0, 0, Math.PI * 2);
      splashCtx.stroke();
    }
    splashCtx.restore();
  }

  function typeLogLine(index) {
    if(index >= bootMessages.length) return;
    const line = document.createElement('div');
    line.textContent = bootMessages[index];
    splashLog.appendChild(line);
    
    setTimeout(() => typeLogLine(index + 1), 350 + Math.random() * 300);
  }

  function startBoot() {
    fitSplashCanvas();
    drawSplashGlobe();
    typeLogLine(0);
    
    setTimeout(() => {
      splash.classList.add('fade-out');
      setTimeout(() => {
        splash.style.display = 'none';
        initApp();
      }, 1000);
    }, 5000 + Math.random() * 2000);
  }

  // DRAGGABLE TERMINAL
  function makeDraggable(panel, handle) {
    let isDragging = false, startX, startY, startLeft, startTop;
    
    const saved = localStorage.getItem('term-pos');
    if(saved) {
      const {left, top} = JSON.parse(saved);
      panel.style.left = left + 'px';
      panel.style.top = top + 'px';
      panel.style.bottom = 'auto';
    }
    
    handle.addEventListener('mousedown', (e) => {
      isDragging = true;
      startX = e.clientX;
      startY = e.clientY;
      const rect = panel.getBoundingClientRect();
      startLeft = rect.left;
      startTop = rect.top;
      panel.style.bottom = 'auto';
      e.preventDefault();
    });
    
    window.addEventListener('mousemove', (e) => {
      if(!isDragging) return;
      let newLeft = startLeft + (e.clientX - startX);
      let newTop = startTop + (e.clientY - startY);
      newLeft = Math.max(0, Math.min(newLeft, window.innerWidth - panel.offsetWidth));
      newTop = Math.max(0, Math.min(newTop, window.innerHeight - panel.offsetHeight));
      panel.style.left = newLeft + 'px';
      panel.style.top = newTop + 'px';
    });
    
    window.addEventListener('mouseup', () => {
      if(isDragging) {
        isDragging = false;
        localStorage.setItem('term-pos', JSON.stringify({
          left: parseInt(panel.style.left),
          top: parseInt(panel.style.top)
        }));
      }
    });
  }

  // MAIN APP
  const termOut = document.getElementById('terminal-output');
  const cmdInput = document.getElementById('command-input');
  const worldCanvas = document.getElementById('world-canvas');
  const chartCanvas = document.getElementById('chart-canvas');
  const worldCtx = worldCanvas.getContext('2d');
  const chartCtx = chartCanvas.getContext('2d');

  function print(text) {
    const div = document.createElement('div');
    div.textContent = text;
    termOut.appendChild(div);
    termOut.scrollTop = termOut.scrollHeight;
  }

  function fitCanvas(c, ctx) {
    const dpr = window.devicePixelRatio || 1;
    const w = c.clientWidth, h = c.clientHeight;
    c.width = w * dpr;
    c.height = h * dpr;
    c.style.width = w + 'px';
    c.style.height = h + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }

  function drawWorld() {
    const w = worldCanvas.clientWidth, h = worldCanvas.clientHeight;
    worldCtx.clearRect(0, 0, w, h);
    
    worldCtx.save();
    worldCtx.strokeStyle = '#2fa62f';
    worldCtx.globalAlpha = 0.12;
    worldCtx.lineWidth = 0.6;
    for(let i = 0; i <= 20; i++) {
      worldCtx.beginPath();
      worldCtx.moveTo(i * w / 20, 0);
      worldCtx.lineTo(i * w / 20, h);
      worldCtx.stroke();
    }
    for(let i = 0; i <= 12; i++) {
      worldCtx.beginPath();
      worldCtx.moveTo(0, i * h / 12);
      worldCtx.lineTo(w, i * h / 12);
      worldCtx.stroke();
    }
    worldCtx.restore();
    
    // Simple continent outlines
    worldCtx.save();
    worldCtx.strokeStyle = '#33ff33';
    worldCtx.globalAlpha = 0.6;
    worldCtx.lineWidth = 1;
    
    // North America
    worldCtx.beginPath();
    worldCtx.moveTo(w*0.15, h*0.2);
    worldCtx.lineTo(w*0.25, h*0.15);
    worldCtx.lineTo(w*0.3, h*0.35);
    worldCtx.lineTo(w*0.2, h*0.5);
    worldCtx.lineTo(w*0.15, h*0.2);
    worldCtx.stroke();
    
    // Europe
    worldCtx.beginPath();
    worldCtx.moveTo(w*0.48, h*0.25);
    worldCtx.lineTo(w*0.52, h*0.22);
    worldCtx.lineTo(w*0.55, h*0.3);
    worldCtx.lineTo(w*0.48, h*0.25);
    worldCtx.stroke();
    
    worldCtx.restore();
  }

  function drawChart() {
    const w = chartCanvas.clientWidth, h = chartCanvas.clientHeight;
    chartCtx.clearRect(0, 0, w, h);
    
    chartCtx.save();
    chartCtx.strokeStyle = '#2fa62f';
    chartCtx.globalAlpha = 0.1;
    chartCtx.lineWidth = 0.6;
    for(let i = 0; i <= 10; i++) {
      chartCtx.beginPath();
      chartCtx.moveTo(i * w / 10, 0);
      chartCtx.lineTo(i * w / 10, h);
      chartCtx.stroke();
    }
    for(let i = 0; i <= 6; i++) {
      chartCtx.beginPath();
      chartCtx.moveTo(0, i * h / 6);
      chartCtx.lineTo(w, i * h / 6);
      chartCtx.stroke();
    }
    chartCtx.restore();
    
    // Sample bars
    chartCtx.save();
    chartCtx.fillStyle = '#33ff33';
    chartCtx.globalAlpha = 0.7;
    const barW = 40, gap = 20;
    for(let i = 0; i < 5; i++) {
      const barH = (50 + Math.random() * 150);
      chartCtx.fillRect(50 + i * (barW + gap), h - 40 - barH, barW, barH);
    }
    chartCtx.restore();
  }

  function redraw() {
    fitCanvas(worldCanvas, worldCtx);
    fitCanvas(chartCanvas, chartCtx);
    drawWorld();
    drawChart();
  }

  function initApp() {
    document.getElementById('status').textContent = 'ONLINE';
    print('WOPR CHANNEL OPERATIONS CONSOLE');
    print('TYPE HELP FOR COMMANDS');
    print('');
    
    makeDraggable(
      document.getElementById('terminal-section'),
      document.getElementById('term-handle')
    );
    
    redraw();
    window.addEventListener('resize', redraw);
  }

  cmdInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter') {
      const cmd = cmdInput.value.trim().toUpperCase();
      if(cmd) {
        print('> ' + cmd);
        if(cmd === 'HELP') {
          print('AVAILABLE COMMANDS:');
          print('  HELP - Show commands');
          print('  STATUS - System status');
          print('  CLEAR - Clear terminal');
        } else if(cmd === 'STATUS') {
          print('SYSTEM STATUS: OPERATIONAL');
          print('DEFCON: 5');
        } else if(cmd === 'CLEAR') {
          termOut.innerHTML = '';
        } else {
          print('UNKNOWN COMMAND');
        }
        print('');
        cmdInput.value = '';
      }
    }
  });

  startBoot();
  </script>
</body>
</html>
